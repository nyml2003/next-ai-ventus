# 文章编辑器设计

## 页面目标

提供流畅的写作体验，支持实时预览、标签管理、状态切换。

## 用户场景

| 场景 | 用户行为 |
|------|---------|
| 新建文章 | 输入标题，开始写作，实时预览效果 |
| 编辑已有文章 | 修改内容，对比预览，保存更新 |
| 草稿暂存 | 写作中途保存为草稿，下次继续 |
| 正式发布 | 确认无误后，点击发布 |

## 模块清单

### 1. Sidebar（侧边导航）

**注意：**编辑器页面通常隐藏 Sidebar，或使用极简版，专注于写作。

可选方案：
- **方案 A**：保留 Sidebar，但默认折叠
- **方案 B**：完全隐藏，顶部 Toolbar 提供返回入口
- **推荐方案 B**，最大化写作区域

### 2. Toolbar（顶部工具栏）

**功能：**
- 返回按钮（返回文章管理页）
- 文章标题输入框（位于中间）
- 操作按钮：保存、发布/更新、设置

**布局：**
```
┌──────────────────────────────────────────────────────────┐
│  [← 返回]          [输入文章标题...]           [💾] [发布] │
└──────────────────────────────────────────────────────────┘
```

**按钮说明：**
- 💾 保存：保存为草稿，不发布
- 发布：新建文章时显示「发布」
- 更新：已有文章时显示「更新」

**保存状态提示：**
```
┌──────────────────────────────────────────────────────────┐
│  [← 返回]  如何设计高性能博客...     [💾] [更新]  ✓ 已保存 │
└──────────────────────────────────────────────────────────┘
```

### 3. Editor（Markdown 编辑器）

**功能：**
- Markdown 文本输入
- 语法高亮
- 快捷键支持（Ctrl+S 保存、Ctrl+B 加粗等）

**布局：**
- 纯文本编辑区域
- 等宽字体，舒适行高
- 行号显示（可选）

### 4. Preview（实时预览）

**功能：**
- 实时渲染 Markdown 为 HTML
- 与最终展示效果一致
- 同步滚动（可选）

### 5. Settings（侧边设置面板）

**功能：**
- 文章元信息管理

**设置项：**
```
┌─────────────────────────┐
│  ⚙️ 文章设置             │
├─────────────────────────┤
│                         │
│  文章链接               │
│  [hello-world]          │
│                         │
│  标签                   │
│  [架构] [Go] [x]        │
│  [+ 添加标签]            │
│                         │
│  状态                   │
│  ( ) 草稿               │
│  (●) 已发布             │
│                         │
│  发布时间               │
│  [2024-06-15]           │
│                         │
├─────────────────────────┤
│  [删除文章]              │
└─────────────────────────┘
```

## 页面布局

### 桌面端（双栏）

```
┌──────────────────────────────────────────────────────────┐
│  [← 返回]     [输入文章标题...]              [💾] [发布]   │
├───────────────────────────────────────┬──────────────────┤
│                                       │                  │
│             Editor                    │    Preview       │
│                                       │                  │
│  ```go                                │   (渲染效果)      │
│  func main() {                        │                  │
│      fmt.Println("Hello")             │   Hello          │
│  }                                    │                  │
│  ```                                  │                  │
│                                       │                  │
│  文章内容...                           │   文章内容...    │
│                                       │                  │
│                                       │                  │
│                                       │                  │
└───────────────────────────────────────┴──────────────────┘
```

### 带设置面板的三栏布局

```
┌──────────────────────────────────────────────────────────┐
│  [← 返回]     [输入文章标题...]              [💾] [发布]   │
├───────────────────────────┬───────────┬──────────────────┤
│                           │           │                  │
│         Editor            │  Preview  │    Settings      │
│                           │           │                  │
│                           │           │  标签            │
│                           │           │  状态            │
│                           │           │  发布时间        │
│                           │           │                  │
│                           │           │                  │
└───────────────────────────┴───────────┴──────────────────┘
```



## 编辑器交互

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl/Cmd + S | 保存草稿 |
| Ctrl/Cmd + B | 加粗选中文本 |
| Ctrl/Cmd + I | 斜体选中文本 |
| Ctrl/Cmd + K | 插入链接 |
| Ctrl/Cmd + Shift + K | 插入代码块 |
| Ctrl/Cmd + U | 上传图片（自动插入链接） |

### 图片上传

- 支持拖拽图片到编辑器
- 支持粘贴图片（截图后 Ctrl+V）
- 支持点击工具栏上传按钮
- 上传完成后自动插入 Markdown 图片语法

### 自动保存

- 停止输入 5 秒后自动保存
- 保存时 Toolbar 显示「已保存」提示
- 浏览器关闭前提示有未保存内容

## 新建 vs 编辑

### 新建文章

- 标题为空，placeholder「输入文章标题...」
- 内容为空，placeholder 显示 Markdown 语法示例
- 状态默认为「草稿」
- 按钮显示「发布」

### 编辑文章

- 标题和内容填充现有数据
- 按钮显示「更新」
- 显示「最后保存时间」

## 异常处理

### 内容冲突（乐观锁）

```
⚠️ 文章已被修改

该文章在其他地方被修改，请刷新页面查看最新内容。

[刷新页面] [取消]
```

### 保存失败

```
❌ 保存失败

网络错误，请检查网络后重试。

[重试] [取消]
```

### 离开确认

```
您有未保存的更改，确定要离开吗？

[离开] [取消]
```
